{"ast":null,"code":"import { blackboard } from '../core/Blackboard';\nconst LOG = msg => console.log(`[System] ${msg}`);\n\n// --- 0. ARCHITECTURAL DATA ---\n_c = LOG;\nconst ROOM_SPECS = {\n  'living': {\n    weight: 2.0,\n    minRatio: 0.8,\n    maxRatio: 1.5,\n    zone: 'FRONT'\n  },\n  'garage': {\n    weight: 1.8,\n    minRatio: 1.0,\n    maxRatio: 1.2,\n    zone: 'FRONT'\n  },\n  'dining': {\n    weight: 1.2,\n    minRatio: 1.0,\n    maxRatio: 1.5,\n    zone: 'REAR'\n  },\n  'kitchen': {\n    weight: 1.4,\n    minRatio: 1.0,\n    maxRatio: 1.4,\n    zone: 'REAR'\n  },\n  'master-bed': {\n    weight: 1.6,\n    minRatio: 1.0,\n    maxRatio: 1.3,\n    zone: 'REAR'\n  },\n  'bedroom': {\n    weight: 1.2,\n    minRatio: 0.9,\n    maxRatio: 1.2,\n    zone: 'ANY'\n  },\n  'study': {\n    weight: 0.9,\n    minRatio: 1.0,\n    maxRatio: 1.5,\n    zone: 'ANY'\n  },\n  'library': {\n    weight: 1.1,\n    minRatio: 1.0,\n    maxRatio: 1.5,\n    zone: 'REAR'\n  },\n  'bathroom': {\n    weight: 0.6,\n    minRatio: 1.0,\n    maxRatio: 2.0,\n    zone: 'SERVICE'\n  },\n  'utility': {\n    weight: 0.7,\n    minRatio: 1.2,\n    maxRatio: 2.0,\n    zone: 'SERVICE'\n  },\n  'prayer': {\n    weight: 0.6,\n    minRatio: 1.0,\n    maxRatio: 1.5,\n    zone: 'ANY'\n  },\n  'store': {\n    weight: 0.4,\n    minRatio: 1.0,\n    maxRatio: 2.0,\n    zone: 'SERVICE'\n  }\n};\nconst SMALL_ROOMS = ['bathroom', 'prayer', 'utility', 'store', 'study'];\n\n// --- AGENTS ---\n\n// 1. Requirement Agent (Smart Distributor)\nconst RequirementAgent = async config => {\n  LOG('Allocating spaces based on privacy zoning...');\n  const pad = 4;\n  blackboard.write('config', config);\n  blackboard.write('siteBoundary', {\n    x: pad,\n    y: pad,\n    w: config.width - pad * 2,\n    h: config.depth - pad * 2\n  });\n  const floorQueues = Array.from({\n    length: config.floors\n  }, () => []);\n  const rooms = {\n    ...config.rooms\n  };\n  const addTo = (f, t) => floorQueues[Math.min(f, config.floors - 1)].push(t);\n\n  // --- GROUND FLOOR (Public & Service) ---\n  if (rooms.garage > 0) {\n    addTo(0, 'garage');\n    rooms.garage--;\n  }\n  if (rooms.living > 0) {\n    addTo(0, 'living');\n    rooms.living--;\n  }\n  if (rooms.dining > 0) {\n    addTo(0, 'dining');\n    rooms.dining--;\n  }\n  if (rooms.kitchen > 0) {\n    addTo(0, 'kitchen');\n    rooms.kitchen--;\n  }\n\n  // Dump utilitarian stuff on Ground\n  ['utility', 'store'].forEach(t => {\n    while (rooms[t] > 0) {\n      addTo(0, t);\n      rooms[t]--;\n    }\n  });\n\n  // Guest Bedroom on Ground?\n  if (config.rooms.bedroom >= 4) {\n    addTo(0, 'bedroom');\n    rooms.bedroom--;\n  }\n  if (rooms.bathroom > 0) {\n    addTo(0, 'bathroom');\n    rooms.bathroom--;\n  } // Guest Bath\n\n  // --- UPPER FLOORS (Private) ---\n  let curF = config.floors > 1 ? 1 : 0;\n\n  // Master Suite\n  if (rooms.bedroom > 0) {\n    addTo(curF, 'master-bed');\n    rooms.bedroom--;\n    if (rooms.bathroom > 0) {\n      addTo(curF, 'bathroom');\n      rooms.bathroom--;\n    } // Ensuite\n  }\n\n  // Rest of Bedrooms\n  while (rooms.bedroom > 0) {\n    addTo(curF, 'bedroom');\n    rooms.bedroom--;\n    // Shared bath for every 2 rooms approx\n    if (rooms.bathroom > 0 && floorQueues[curF].filter(r => r === 'bathroom').length < 2) {\n      addTo(curF, 'bathroom');\n      rooms.bathroom--;\n    }\n    if (config.floors > 2 && curF < config.floors - 1) curF++;\n  }\n\n  // Any remaining baths/prayer/library\n  ['bathroom', 'prayer', 'library'].forEach(t => {\n    while (rooms[t] > 0) {\n      addTo(curF, t);\n      rooms[t]--;\n    }\n  });\n  blackboard.write('floorQueues', floorQueues);\n  return true;\n};\n\n// 2. Advanced Layout Agent (Quadrant Corner Solver)\n_c2 = RequirementAgent;\nconst LayoutAgent = async () => {\n  LOG('Solving quadrant constraints...');\n  const bounds = blackboard.read('siteBoundary');\n  const floorQueues = blackboard.read('floorQueues');\n  const allRegions = [];\n\n  // Main Spine Dimensions\n  const hallW = 6;\n  const hallX = bounds.x + (bounds.w - hallW) / 2;\n  floorQueues.forEach((roomList, floorIdx) => {\n    const floorRegions = [];\n\n    // 1. Place Fixed Spine (Central Cross if large, or Line)\n    // We use a T-Shape Hallway for better access\n    const hallMain = {\n      x: hallX,\n      y: bounds.y + 10,\n      w: hallW,\n      h: bounds.h - 15,\n      type: 'hallway'\n    };\n    floorRegions.push(hallMain);\n    if (blackboard.read('config').floors > 1) {\n      floorRegions.push({\n        x: hallX,\n        y: bounds.y + bounds.h - 12,\n        w: hallW,\n        h: 8,\n        type: 'stairs'\n      });\n    }\n\n    // 2. Define 4 Quadrants\n    const quadW = (bounds.w - hallW) / 2;\n    const quadH = bounds.h / 2;\n\n    // Q1: Back Left (Kitchens, Dining)\n    const qBL = {\n      x: bounds.x,\n      y: bounds.y,\n      w: quadW,\n      h: quadH\n    };\n    // Q2: Back Right (Master Bed, Library)\n    const qBR = {\n      x: hallX + hallW,\n      y: bounds.y,\n      w: quadW,\n      h: quadH\n    };\n    // Q3: Front Left (Living)\n    const qFL = {\n      x: bounds.x,\n      y: bounds.y + quadH,\n      w: quadW,\n      h: quadH\n    };\n    // Q4: Front Right (Garage, Guest)\n    const qFR = {\n      x: hallX + hallW,\n      y: bounds.y + quadH,\n      w: quadW,\n      h: quadH\n    };\n    const buckets = {\n      BL: [],\n      BR: [],\n      FL: [],\n      FR: []\n    };\n\n    // 3. Intelligent Sorting (The \"Architect's Brain\")\n    roomList.forEach(r => {\n      const spec = ROOM_SPECS[r] || {\n        zone: 'ANY'\n      };\n\n      // Forced Zones\n      if (r === 'kitchen') buckets.BL.push(r);else if (r === 'garage') buckets.FR.push(r);else if (r === 'master-bed') buckets.BR.push(r); // Privacy corner\n      else if (r === 'living') buckets.FL.push(r);else if (r === 'dining') buckets.BL.push(r); // Near Kitchen\n\n      // Smart Fill for \"ANY\" / \"SERVICE\"\n      else {\n        // Find emptiest quadrant that makes sense\n        const counts = [buckets.BL.length, buckets.BR.length, buckets.FL.length, buckets.FR.length];\n        const min = Math.min(...counts);\n        if (buckets.BR.length === min) buckets.BR.push(r); // Prefer back for beds\n        else if (buckets.BL.length === min) buckets.BL.push(r);else if (buckets.FL.length === min) buckets.FL.push(r);else buckets.FR.push(r);\n      }\n    });\n\n    // 4. Recursive Solver for each Quadrant\n    const solveQuadrant = (rect, items) => {\n      if (items.length === 0) return;\n\n      // Sort: Large rooms first, then small\n      items.sort((a, b) => {\n        var _ROOM_SPECS$b, _ROOM_SPECS$a;\n        return (((_ROOM_SPECS$b = ROOM_SPECS[b]) === null || _ROOM_SPECS$b === void 0 ? void 0 : _ROOM_SPECS$b.weight) || 1) - (((_ROOM_SPECS$a = ROOM_SPECS[a]) === null || _ROOM_SPECS$a === void 0 ? void 0 : _ROOM_SPECS$a.weight) || 1);\n      });\n\n      // Pass 1: Check for Pairs (Bath + Bed)\n      const pairs = [];\n      const singles = [];\n      while (items.length > 0) {\n        const curr = items.shift();\n        // Try to find a small partner\n        const partnerIdx = items.findIndex(i => SMALL_ROOMS.includes(i));\n        if (!SMALL_ROOMS.includes(curr) && partnerIdx !== -1) {\n          // Pair Big + Small (e.g., Bed + Bath)\n          pairs.push({\n            big: curr,\n            small: items.splice(partnerIdx, 1)[0]\n          });\n        } else {\n          singles.push(curr);\n        }\n      }\n      let currentY = rect.y;\n      const totalH = rect.h;\n      // Heuristic: Each \"Row\" takes a chunk of height\n      const rowCount = pairs.length + singles.length;\n      const baseH = totalH / rowCount;\n\n      // Render Pairs (Split Vertically)\n      pairs.forEach(p => {\n        const h = baseH;\n        // Big room takes 2/3 width, Small takes 1/3\n        const splitX = rect.x + rect.w * 0.65;\n        floorRegions.push({\n          x: rect.x,\n          y: currentY,\n          w: rect.w * 0.65,\n          h: h,\n          type: p.big\n        });\n        floorRegions.push({\n          x: splitX,\n          y: currentY,\n          w: rect.w * 0.35,\n          h: h,\n          type: p.small\n        });\n        currentY += h;\n      });\n\n      // Render Singles (Full Width)\n      singles.forEach(s => {\n        // Check if it's a \"Twin Small\" situation (Two small rooms side by side)\n        // Not implemented for brevity, strictly stacking singles\n        floorRegions.push({\n          x: rect.x,\n          y: currentY,\n          w: rect.w,\n          h: baseH,\n          type: s\n        });\n        currentY += baseH;\n      });\n    };\n    solveQuadrant(qBL, buckets.BL);\n    solveQuadrant(qBR, buckets.BR);\n    solveQuadrant(qFL, buckets.FL);\n    solveQuadrant(qFR, buckets.FR);\n    allRegions.push(floorRegions);\n  });\n  blackboard.write('floorRegions', allRegions);\n  return true;\n};\n\n// 3. Structural Agent (Optimized)\n_c3 = LayoutAgent;\nconst StructuralAgent = async () => {\n  LOG('Generating load-bearing skeleton...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allWalls = [];\n  floorRegions.forEach(rooms => {\n    const walls = [];\n    rooms.forEach(r => {\n      // Draw box\n      walls.push({\n        x1: r.x,\n        y1: r.y,\n        x2: r.x + r.w,\n        y2: r.y,\n        type: 'inner'\n      });\n      walls.push({\n        x1: r.x,\n        y1: r.y + r.h,\n        x2: r.x + r.w,\n        y2: r.y + r.h,\n        type: 'inner'\n      });\n      walls.push({\n        x1: r.x,\n        y1: r.y,\n        x2: r.x,\n        y2: r.y + r.h,\n        type: 'inner'\n      });\n      walls.push({\n        x1: r.x + r.w,\n        y1: r.y,\n        x2: r.x + r.w,\n        y2: r.y + r.h,\n        type: 'inner'\n      });\n    });\n\n    // Outer Shell (Thicker in UI)\n    const b = blackboard.read('siteBoundary');\n    const outer = [{\n      x1: b.x,\n      y1: b.y,\n      x2: b.x + b.w,\n      y2: b.y\n    }, {\n      x1: b.x,\n      y1: b.y + b.h,\n      x2: b.x + b.w,\n      y2: b.y + b.h\n    }, {\n      x1: b.x,\n      y1: b.y,\n      x2: b.x,\n      y2: b.y + b.h\n    }, {\n      x1: b.x + b.w,\n      y1: b.y,\n      x2: b.x + b.w,\n      y2: b.y + b.h\n    }];\n    allWalls.push({\n      inner: walls,\n      outer: outer\n    });\n  });\n  blackboard.write('floorWalls', allWalls);\n  return true;\n};\n\n// 4. Connectivity Agent (Door Logic)\n_c4 = StructuralAgent;\nconst ConnectivityAgent = async () => {\n  LOG('Placing doors...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allDoors = [];\n  floorRegions.forEach((rooms, floorIndex) => {\n    const doors = [];\n\n    // Helper to add unique door\n    const addDoor = d => {\n      // Simple dedup\n      if (!doors.some(ed => Math.abs(ed.x - d.x) < 1 && Math.abs(ed.y - d.y) < 1)) {\n        doors.push(d);\n      }\n    };\n    for (let i = 0; i < rooms.length; i++) {\n      for (let j = i + 1; j < rooms.length; j++) {\n        const r1 = rooms[i];\n        const r2 = rooms[j];\n\n        // Check adjacency\n        const isTouchingY = Math.abs(r1.y + r1.h - r2.y) < 0.1 || Math.abs(r2.y + r2.h - r1.y) < 0.1;\n        const isTouchingX = Math.abs(r1.x + r1.w - r2.x) < 0.1 || Math.abs(r2.x + r2.w - r1.x) < 0.1;\n        const overlapX = Math.min(r1.x + r1.w, r2.x + r2.w) - Math.max(r1.x, r2.x);\n        const overlapY = Math.min(r1.y + r1.h, r2.y + r2.h) - Math.max(r1.y, r2.y);\n        const r1IsHall = r1.type === 'hallway';\n        const r2IsHall = r2.type === 'hallway';\n        const isEnsuite = r1.type === 'bathroom' && !r2IsHall || r2.type === 'bathroom' && !r1IsHall;\n\n        // Logic: Doors connect to Halls, OR Ensuites connect to Rooms\n        if (r1IsHall || r2IsHall || isEnsuite) {\n          if (isTouchingY && overlapX > 3) {\n            // Horizontal Door\n            const mid = Math.max(r1.x, r2.x) + overlapX / 2;\n            addDoor({\n              x: mid - 1.5,\n              y: r1.y < r2.y ? r2.y : r1.y,\n              w: 3,\n              vertical: false\n            });\n          } else if (isTouchingX && overlapY > 3) {\n            // Vertical Door\n            const mid = Math.max(r1.y, r2.y) + overlapY / 2;\n            addDoor({\n              x: r1.x < r2.x ? r2.x : r1.x,\n              y: mid - 1.5,\n              w: 3,\n              vertical: true\n            });\n          }\n        }\n      }\n    }\n    // Main Entrance\n    if (floorIndex === 0) {\n      const hall = rooms.find(r => r.type === 'hallway');\n      if (hall) addDoor({\n        x: hall.x + hall.w / 2 - 2,\n        y: hall.y + hall.h,\n        w: 4,\n        vertical: false\n      });\n    }\n    allDoors.push(doors);\n  });\n  blackboard.write('floorDoors', allDoors);\n  return true;\n};\n_c5 = ConnectivityAgent;\nexport const agents = [{\n  name: 'Zoning & Allocation',\n  fn: RequirementAgent\n}, {\n  name: 'Quadrant Solver',\n  fn: LayoutAgent\n}, {\n  name: 'Structural Skeleton',\n  fn: StructuralAgent\n}, {\n  name: 'Pathfinding',\n  fn: ConnectivityAgent\n}];\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"LOG\");\n$RefreshReg$(_c2, \"RequirementAgent\");\n$RefreshReg$(_c3, \"LayoutAgent\");\n$RefreshReg$(_c4, \"StructuralAgent\");\n$RefreshReg$(_c5, \"ConnectivityAgent\");","map":{"version":3,"names":["blackboard","LOG","msg","console","log","_c","ROOM_SPECS","weight","minRatio","maxRatio","zone","SMALL_ROOMS","RequirementAgent","config","pad","write","x","y","w","width","h","depth","floorQueues","Array","from","length","floors","rooms","addTo","f","t","Math","min","push","garage","living","dining","kitchen","forEach","bedroom","bathroom","curF","filter","r","_c2","LayoutAgent","bounds","read","allRegions","hallW","hallX","roomList","floorIdx","floorRegions","hallMain","type","quadW","quadH","qBL","qBR","qFL","qFR","buckets","BL","BR","FL","FR","spec","counts","solveQuadrant","rect","items","sort","a","b","_ROOM_SPECS$b","_ROOM_SPECS$a","pairs","singles","curr","shift","partnerIdx","findIndex","i","includes","big","small","splice","currentY","totalH","rowCount","baseH","p","splitX","s","_c3","StructuralAgent","allWalls","walls","x1","y1","x2","y2","outer","inner","_c4","ConnectivityAgent","allDoors","floorIndex","doors","addDoor","d","some","ed","abs","j","r1","r2","isTouchingY","isTouchingX","overlapX","max","overlapY","r1IsHall","r2IsHall","isEnsuite","mid","vertical","hall","find","_c5","agents","name","fn","$RefreshReg$"],"sources":["E:/PAP/SEM 5  (Current)/Agent Based Software Engineering (ABSE)/Schematic-Architecture-Generator/ShamArchitectSys_Final/src/agents/AgentSystem.js"],"sourcesContent":["import { blackboard } from '../core/Blackboard';\n\nconst LOG = (msg) => console.log(`[System] ${msg}`);\n\n// --- 0. ARCHITECTURAL DATA ---\n\nconst ROOM_SPECS = {\n  'living':     { weight: 2.0, minRatio: 0.8, maxRatio: 1.5, zone: 'FRONT' },\n  'garage':     { weight: 1.8, minRatio: 1.0, maxRatio: 1.2, zone: 'FRONT' },\n  'dining':     { weight: 1.2, minRatio: 1.0, maxRatio: 1.5, zone: 'REAR' },\n  'kitchen':    { weight: 1.4, minRatio: 1.0, maxRatio: 1.4, zone: 'REAR' },\n  'master-bed': { weight: 1.6, minRatio: 1.0, maxRatio: 1.3, zone: 'REAR' },\n  'bedroom':    { weight: 1.2, minRatio: 0.9, maxRatio: 1.2, zone: 'ANY' },\n  'study':      { weight: 0.9, minRatio: 1.0, maxRatio: 1.5, zone: 'ANY' },\n  'library':    { weight: 1.1, minRatio: 1.0, maxRatio: 1.5, zone: 'REAR' },\n  'bathroom':   { weight: 0.6, minRatio: 1.0, maxRatio: 2.0, zone: 'SERVICE' },\n  'utility':    { weight: 0.7, minRatio: 1.2, maxRatio: 2.0, zone: 'SERVICE' },\n  'prayer':     { weight: 0.6, minRatio: 1.0, maxRatio: 1.5, zone: 'ANY' },\n  'store':      { weight: 0.4, minRatio: 1.0, maxRatio: 2.0, zone: 'SERVICE' }\n};\n\nconst SMALL_ROOMS = ['bathroom', 'prayer', 'utility', 'store', 'study'];\n\n// --- AGENTS ---\n\n// 1. Requirement Agent (Smart Distributor)\nconst RequirementAgent = async (config) => {\n  LOG('Allocating spaces based on privacy zoning...');\n  \n  const pad = 4;\n  blackboard.write('config', config);\n  blackboard.write('siteBoundary', { x: pad, y: pad, w: config.width-(pad*2), h: config.depth-(pad*2) });\n  \n  const floorQueues = Array.from({ length: config.floors }, () => []);\n  const rooms = { ...config.rooms };\n\n  const addTo = (f, t) => floorQueues[Math.min(f, config.floors-1)].push(t);\n\n  // --- GROUND FLOOR (Public & Service) ---\n  if(rooms.garage > 0) { addTo(0, 'garage'); rooms.garage--; }\n  if(rooms.living > 0) { addTo(0, 'living'); rooms.living--; }\n  if(rooms.dining > 0) { addTo(0, 'dining'); rooms.dining--; }\n  if(rooms.kitchen > 0) { addTo(0, 'kitchen'); rooms.kitchen--; }\n  \n  // Dump utilitarian stuff on Ground\n  ['utility','store'].forEach(t => { while(rooms[t] > 0) { addTo(0, t); rooms[t]--; }});\n\n  // Guest Bedroom on Ground?\n  if(config.rooms.bedroom >= 4) { addTo(0, 'bedroom'); rooms.bedroom--; }\n  if(rooms.bathroom > 0) { addTo(0, 'bathroom'); rooms.bathroom--; } // Guest Bath\n\n  // --- UPPER FLOORS (Private) ---\n  let curF = config.floors > 1 ? 1 : 0;\n  \n  // Master Suite\n  if(rooms.bedroom > 0) {\n     addTo(curF, 'master-bed'); rooms.bedroom--;\n     if(rooms.bathroom > 0) { addTo(curF, 'bathroom'); rooms.bathroom--; } // Ensuite\n  }\n\n  // Rest of Bedrooms\n  while(rooms.bedroom > 0) {\n     addTo(curF, 'bedroom'); rooms.bedroom--;\n     // Shared bath for every 2 rooms approx\n     if(rooms.bathroom > 0 && floorQueues[curF].filter(r=>r==='bathroom').length < 2) {\n        addTo(curF, 'bathroom'); rooms.bathroom--;\n     }\n     \n     if(config.floors > 2 && curF < config.floors-1) curF++;\n  }\n\n  // Any remaining baths/prayer/library\n  ['bathroom','prayer','library'].forEach(t => {\n      while(rooms[t] > 0) { addTo(curF, t); rooms[t]--; }\n  });\n\n  blackboard.write('floorQueues', floorQueues);\n  return true;\n};\n\n// 2. Advanced Layout Agent (Quadrant Corner Solver)\nconst LayoutAgent = async () => {\n  LOG('Solving quadrant constraints...');\n  const bounds = blackboard.read('siteBoundary');\n  const floorQueues = blackboard.read('floorQueues');\n  const allRegions = [];\n\n  // Main Spine Dimensions\n  const hallW = 6; \n  const hallX = bounds.x + (bounds.w - hallW) / 2;\n\n  floorQueues.forEach((roomList, floorIdx) => {\n    const floorRegions = [];\n    \n    // 1. Place Fixed Spine (Central Cross if large, or Line)\n    // We use a T-Shape Hallway for better access\n    const hallMain = { x: hallX, y: bounds.y + 10, w: hallW, h: bounds.h - 15, type: 'hallway' };\n    floorRegions.push(hallMain);\n    \n    if (blackboard.read('config').floors > 1) {\n       floorRegions.push({ x: hallX, y: bounds.y + bounds.h - 12, w: hallW, h: 8, type: 'stairs' });\n    }\n\n    // 2. Define 4 Quadrants\n    const quadW = (bounds.w - hallW) / 2;\n    const quadH = bounds.h / 2;\n    \n    // Q1: Back Left (Kitchens, Dining)\n    const qBL = { x: bounds.x, y: bounds.y, w: quadW, h: quadH };\n    // Q2: Back Right (Master Bed, Library)\n    const qBR = { x: hallX + hallW, y: bounds.y, w: quadW, h: quadH };\n    // Q3: Front Left (Living)\n    const qFL = { x: bounds.x, y: bounds.y + quadH, w: quadW, h: quadH };\n    // Q4: Front Right (Garage, Guest)\n    const qFR = { x: hallX + hallW, y: bounds.y + quadH, w: quadW, h: quadH };\n\n    const buckets = { BL: [], BR: [], FL: [], FR: [] };\n\n    // 3. Intelligent Sorting (The \"Architect's Brain\")\n    roomList.forEach(r => {\n      const spec = ROOM_SPECS[r] || { zone: 'ANY' };\n      \n      // Forced Zones\n      if (r === 'kitchen') buckets.BL.push(r);\n      else if (r === 'garage') buckets.FR.push(r);\n      else if (r === 'master-bed') buckets.BR.push(r); // Privacy corner\n      else if (r === 'living') buckets.FL.push(r);\n      else if (r === 'dining') buckets.BL.push(r);     // Near Kitchen\n      \n      // Smart Fill for \"ANY\" / \"SERVICE\"\n      else {\n        // Find emptiest quadrant that makes sense\n        const counts = [buckets.BL.length, buckets.BR.length, buckets.FL.length, buckets.FR.length];\n        const min = Math.min(...counts);\n        \n        if (buckets.BR.length === min) buckets.BR.push(r); // Prefer back for beds\n        else if (buckets.BL.length === min) buckets.BL.push(r);\n        else if (buckets.FL.length === min) buckets.FL.push(r);\n        else buckets.FR.push(r);\n      }\n    });\n\n    // 4. Recursive Solver for each Quadrant\n    const solveQuadrant = (rect, items) => {\n       if(items.length === 0) return;\n       \n       // Sort: Large rooms first, then small\n       items.sort((a,b) => (ROOM_SPECS[b]?.weight || 1) - (ROOM_SPECS[a]?.weight || 1));\n\n       // Pass 1: Check for Pairs (Bath + Bed)\n       const pairs = [];\n       const singles = [];\n       \n       while(items.length > 0) {\n         const curr = items.shift();\n         // Try to find a small partner\n         const partnerIdx = items.findIndex(i => SMALL_ROOMS.includes(i));\n         if(!SMALL_ROOMS.includes(curr) && partnerIdx !== -1) {\n            // Pair Big + Small (e.g., Bed + Bath)\n            pairs.push({ big: curr, small: items.splice(partnerIdx, 1)[0] });\n         } else {\n            singles.push(curr);\n         }\n       }\n\n       let currentY = rect.y;\n       const totalH = rect.h;\n       // Heuristic: Each \"Row\" takes a chunk of height\n       const rowCount = pairs.length + singles.length;\n       const baseH = totalH / rowCount;\n\n       // Render Pairs (Split Vertically)\n       pairs.forEach(p => {\n         const h = baseH; \n         // Big room takes 2/3 width, Small takes 1/3\n         const splitX = rect.x + (rect.w * 0.65);\n         \n         floorRegions.push({ x: rect.x, y: currentY, w: rect.w * 0.65, h: h, type: p.big });\n         floorRegions.push({ x: splitX, y: currentY, w: rect.w * 0.35, h: h, type: p.small });\n         currentY += h;\n       });\n\n       // Render Singles (Full Width)\n       singles.forEach(s => {\n         // Check if it's a \"Twin Small\" situation (Two small rooms side by side)\n         // Not implemented for brevity, strictly stacking singles\n         floorRegions.push({ x: rect.x, y: currentY, w: rect.w, h: baseH, type: s });\n         currentY += baseH;\n       });\n    };\n\n    solveQuadrant(qBL, buckets.BL);\n    solveQuadrant(qBR, buckets.BR);\n    solveQuadrant(qFL, buckets.FL);\n    solveQuadrant(qFR, buckets.FR);\n\n    allRegions.push(floorRegions);\n  });\n\n  blackboard.write('floorRegions', allRegions);\n  return true;\n};\n\n// 3. Structural Agent (Optimized)\nconst StructuralAgent = async () => {\n  LOG('Generating load-bearing skeleton...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allWalls = [];\n\n  floorRegions.forEach((rooms) => {\n    const walls = [];\n    rooms.forEach(r => {\n      // Draw box\n      walls.push({ x1: r.x, y1: r.y, x2: r.x+r.w, y2: r.y, type: 'inner' });\n      walls.push({ x1: r.x, y1: r.y+r.h, x2: r.x+r.w, y2: r.y+r.h, type: 'inner' });\n      walls.push({ x1: r.x, y1: r.y, x2: r.x, y2: r.y+r.h, type: 'inner' });\n      walls.push({ x1: r.x+r.w, y1: r.y, x2: r.x+r.w, y2: r.y+r.h, type: 'inner' });\n    });\n    \n    // Outer Shell (Thicker in UI)\n    const b = blackboard.read('siteBoundary');\n    const outer = [\n      { x1: b.x, y1: b.y, x2: b.x+b.w, y2: b.y },\n      { x1: b.x, y1: b.y+b.h, x2: b.x+b.w, y2: b.y+b.h },\n      { x1: b.x, y1: b.y, x2: b.x, y2: b.y+b.h },\n      { x1: b.x+b.w, y1: b.y, x2: b.x+b.w, y2: b.y+b.h },\n    ];\n    allWalls.push({ inner: walls, outer: outer });\n  });\n\n  blackboard.write('floorWalls', allWalls);\n  return true;\n};\n\n// 4. Connectivity Agent (Door Logic)\nconst ConnectivityAgent = async () => {\n  LOG('Placing doors...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allDoors = [];\n\n  floorRegions.forEach((rooms, floorIndex) => {\n    const doors = [];\n    \n    // Helper to add unique door\n    const addDoor = (d) => {\n       // Simple dedup\n       if(!doors.some(ed => Math.abs(ed.x - d.x) < 1 && Math.abs(ed.y - d.y) < 1)) {\n          doors.push(d);\n       }\n    };\n\n    for (let i = 0; i < rooms.length; i++) {\n      for (let j = i + 1; j < rooms.length; j++) {\n        const r1 = rooms[i];\n        const r2 = rooms[j];\n        \n        // Check adjacency\n        const isTouchingY = Math.abs(r1.y + r1.h - r2.y) < 0.1 || Math.abs(r2.y + r2.h - r1.y) < 0.1;\n        const isTouchingX = Math.abs(r1.x + r1.w - r2.x) < 0.1 || Math.abs(r2.x + r2.w - r1.x) < 0.1;\n\n        const overlapX = (Math.min(r1.x+r1.w, r2.x+r2.w) - Math.max(r1.x, r2.x));\n        const overlapY = (Math.min(r1.y+r1.h, r2.y+r2.h) - Math.max(r1.y, r2.y));\n\n        const r1IsHall = r1.type === 'hallway';\n        const r2IsHall = r2.type === 'hallway';\n        const isEnsuite = (r1.type === 'bathroom' && !r2IsHall) || (r2.type === 'bathroom' && !r1IsHall);\n\n        // Logic: Doors connect to Halls, OR Ensuites connect to Rooms\n        if ( (r1IsHall || r2IsHall || isEnsuite) ) {\n            if (isTouchingY && overlapX > 3) {\n               // Horizontal Door\n               const mid = Math.max(r1.x, r2.x) + (overlapX/2);\n               addDoor({ x: mid - 1.5, y: (r1.y < r2.y ? r2.y : r1.y), w: 3, vertical: false });\n            } \n            else if (isTouchingX && overlapY > 3) {\n               // Vertical Door\n               const mid = Math.max(r1.y, r2.y) + (overlapY/2);\n               addDoor({ x: (r1.x < r2.x ? r2.x : r1.x), y: mid - 1.5, w: 3, vertical: true });\n            }\n        }\n      }\n    }\n    // Main Entrance\n    if (floorIndex === 0) {\n       const hall = rooms.find(r => r.type === 'hallway');\n       if(hall) addDoor({ x: hall.x + hall.w/2 - 2, y: hall.y + hall.h, w: 4, vertical: false });\n    }\n    allDoors.push(doors);\n  });\n\n  blackboard.write('floorDoors', allDoors);\n  return true;\n};\n\nexport const agents = [\n  { name: 'Zoning & Allocation', fn: RequirementAgent },\n  { name: 'Quadrant Solver', fn: LayoutAgent },\n  { name: 'Structural Skeleton', fn: StructuralAgent },\n  { name: 'Pathfinding', fn: ConnectivityAgent },\n];"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}