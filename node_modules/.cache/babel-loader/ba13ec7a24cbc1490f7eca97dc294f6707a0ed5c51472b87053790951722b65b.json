{"ast":null,"code":"import { blackboard } from '../core/Blackboard';\nconst LOG = msg => console.log(`[System] ${msg}`);\n\n// --- 0. ARCHITECTURAL RULES ---\n\n// 1. Room Sizing Weights (Relative Units)\n_c = LOG;\nconst ROOM_WEIGHTS = {\n  'garage': 1.5,\n  'living': 1.8,\n  // Large\n  'dining': 1.2,\n  'kitchen': 1.3,\n  'master-bed': 1.6,\n  // Spacious\n  'bedroom': 1.2,\n  'library': 1.0,\n  'study': 0.9,\n  'bathroom': 0.6,\n  // Small\n  'prayer': 0.6,\n  // Small\n  'utility': 0.7,\n  'store': 0.4\n};\n\n// 2. Zoning Score (0 = Private/Back, 100 = Public/Front)\nconst ZONING_SCORE = {\n  'utility': 5,\n  'store': 5,\n  'kitchen': 10,\n  'dining': 15,\n  'study': 20,\n  'library': 25,\n  'master-bed': 30,\n  'bedroom': 35,\n  'bathroom': 36,\n  'prayer': 40,\n  'stairs': 50,\n  'living': 80,\n  'garage': 90,\n  'hallway': 50\n};\n\n// 3. Definition of \"Small\" rooms suitable for side-by-side placement\nconst SMALL_ROOMS = ['bathroom', 'prayer', 'utility', 'store', 'study', 'library'];\n\n// --- AGENTS ---\n\n// 1. Requirement Agent (Distributes Rooms)\nconst RequirementAgent = async config => {\n  LOG('Analyzing room inventory...');\n  const pad = 4;\n  const buildW = config.width - pad * 2;\n  const buildD = config.depth - pad * 2;\n  blackboard.write('config', config);\n  blackboard.write('siteBoundary', {\n    x: pad,\n    y: pad,\n    w: buildW,\n    h: buildD\n  });\n  const floorQueues = Array.from({\n    length: config.floors\n  }, () => []);\n  const rooms = {\n    ...config.rooms\n  };\n  const addToFloor = (f, type) => {\n    const target = f < config.floors ? f : config.floors - 1;\n    floorQueues[target].push(type);\n  };\n\n  // --- FLOOR 0: Public & Service ---\n  if (rooms.garage > 0) {\n    addToFloor(0, 'garage');\n    rooms.garage--;\n  }\n  if (rooms.kitchen > 0) {\n    addToFloor(0, 'kitchen');\n    rooms.kitchen--;\n  }\n  if (rooms.dining > 0) {\n    addToFloor(0, 'dining');\n    rooms.dining--;\n  }\n  if (rooms.living > 0) {\n    addToFloor(0, 'living');\n    rooms.living--;\n  }\n\n  // Fill Small Service Rooms\n  ['utility', 'prayer', 'store'].forEach(type => {\n    while (rooms[type] > 0) {\n      addToFloor(0, type);\n      rooms[type]--;\n    }\n  });\n  if (rooms.bathroom > 0) {\n    addToFloor(0, 'bathroom');\n    rooms.bathroom--;\n  }\n\n  // --- UPPER FLOORS: Private ---\n  let currentFloor = config.floors > 1 ? 1 : 0;\n\n  // Master Suite\n  if (rooms.bedroom > 0) {\n    addToFloor(currentFloor, 'master-bed');\n    rooms.bedroom--;\n    if (rooms.bathroom > 0) {\n      addToFloor(currentFloor, 'bathroom');\n      rooms.bathroom--;\n    }\n  }\n\n  // Standard Beds\n  while (rooms.bedroom > 0) {\n    addToFloor(currentFloor, 'bedroom');\n    rooms.bedroom--;\n    if (rooms.bathroom > 0) {\n      addToFloor(currentFloor, 'bathroom');\n      rooms.bathroom--;\n    }\n\n    // Distribute logic\n    if (config.floors > 2 && currentFloor < config.floors - 1) currentFloor++;else if (config.floors > 1) currentFloor = 1;\n  }\n\n  // Library/Office\n  while (rooms.library > 0) {\n    addToFloor(config.floors > 1 ? 1 : 0, 'library');\n    rooms.library--;\n  }\n  blackboard.write('floorQueues', floorQueues);\n  return true;\n};\n\n// 2. Advanced Layout Agent (Smart Splitter)\n_c2 = RequirementAgent;\nconst LayoutAgent = async () => {\n  LOG('Calculating Smart-Split layouts...');\n  const bounds = blackboard.read('siteBoundary');\n  const floorQueues = blackboard.read('floorQueues');\n  const config = blackboard.read('config');\n  const allFloorsRegions = [];\n  const spineW = 6;\n  const spineX = bounds.x + bounds.w / 2 - spineW / 2;\n  for (let f = 0; f < config.floors; f++) {\n    const regions = [];\n    let rooms = floorQueues[f] || [];\n\n    // Fixed Elements\n    const hall = {\n      x: spineX,\n      y: bounds.y + 8,\n      w: spineW,\n      h: bounds.h - 12,\n      type: 'hallway'\n    };\n    regions.push(hall);\n    if (config.floors > 1) {\n      regions.push({\n        x: hall.x,\n        y: hall.y + hall.h - 10,\n        w: hall.w,\n        h: 8,\n        type: 'stairs'\n      });\n    }\n    const leftSpace = {\n      x: bounds.x,\n      y: bounds.y,\n      w: bounds.w / 2 - spineW / 2,\n      h: bounds.h\n    };\n    const rightSpace = {\n      x: spineX + spineW,\n      y: bounds.y,\n      w: bounds.w / 2 - spineW / 2,\n      h: bounds.h\n    };\n\n    // --- THE SMART SLICER ---\n    const smartSlice = (rect, roomList) => {\n      if (roomList.length === 0) return;\n\n      // 1. Zoning Sort\n      roomList.sort((a, b) => (ZONING_SCORE[a] || 50) - (ZONING_SCORE[b] || 50));\n\n      // 2. Optimize: Move baths next to beds if scattered\n      for (let i = 0; i < roomList.length - 1; i++) {\n        if (roomList[i].includes('bed') && roomList[i + 1] !== 'bathroom') {\n          const bathIdx = roomList.findIndex((r, idx) => idx > i && r === 'bathroom');\n          if (bathIdx !== -1) {\n            const bath = roomList.splice(bathIdx, 1)[0];\n            roomList.splice(i + 1, 0, bath);\n          }\n        }\n      }\n\n      // 3. Pre-Calculate total \"Row Weights\" accounting for pairing\n      let effectiveList = [];\n      let i = 0;\n      while (i < roomList.length) {\n        const current = roomList[i];\n        const next = roomList[i + 1];\n\n        // Check for Twin Pair Condition\n        if (next && SMALL_ROOMS.includes(current) && SMALL_ROOMS.includes(next)) {\n          // Create a \"Pair\" object\n          effectiveList.push({\n            type: 'PAIR',\n            items: [current, next],\n            weight: ROOM_WEIGHTS[current] + ROOM_WEIGHTS[next]\n          });\n          i += 2;\n        } else {\n          effectiveList.push({\n            type: 'SINGLE',\n            items: [current],\n            weight: ROOM_WEIGHTS[current] || 1.0\n          });\n          i += 1;\n        }\n      }\n      const totalWeight = effectiveList.reduce((sum, item) => sum + item.weight, 0);\n      let currentY = rect.y;\n\n      // 4. Render Rows\n      effectiveList.forEach(item => {\n        const rowHeight = item.weight / totalWeight * rect.h;\n        if (item.type === 'SINGLE') {\n          // Standard Room\n          regions.push({\n            x: rect.x,\n            y: currentY,\n            w: rect.w,\n            h: rowHeight,\n            type: item.items[0]\n          });\n        } else {\n          // Twin Pair (Side-by-Side Split)\n          const w1 = rect.w * 0.5;\n          const w2 = rect.w - w1;\n          regions.push({\n            x: rect.x,\n            y: currentY,\n            w: w1,\n            h: rowHeight,\n            type: item.items[0]\n          });\n          regions.push({\n            x: rect.x + w1,\n            y: currentY,\n            w: w2,\n            h: rowHeight,\n            type: item.items[1]\n          });\n        }\n        currentY += rowHeight;\n      });\n    };\n\n    // Assign Sides\n    const leftRooms = [];\n    const rightRooms = [];\n    rooms.forEach(r => {\n      if (['garage', 'kitchen', 'dining', 'utility', 'prayer', 'store'].includes(r)) rightRooms.push(r);else leftRooms.push(r);\n    });\n\n    // Balance Check\n    if (leftRooms.length === 0 && rightRooms.length > 1) leftRooms.push(rightRooms.pop());\n    if (rightRooms.length === 0 && leftRooms.length > 1) rightRooms.push(leftRooms.pop());\n    smartSlice(leftSpace, leftRooms);\n    smartSlice(rightSpace, rightRooms);\n    allFloorsRegions.push(regions);\n  }\n  blackboard.write('floorRegions', allFloorsRegions);\n  return true;\n};\n\n// 3. Structural Agent (Walls)\n_c3 = LayoutAgent;\nconst StructuralAgent = async () => {\n  LOG('Aligning structure...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allWalls = [];\n  floorRegions.forEach(rooms => {\n    const walls = [];\n    rooms.forEach(r => {\n      // Box walls for every room\n      walls.push({\n        x1: r.x,\n        y1: r.y,\n        x2: r.x + r.w,\n        y2: r.y,\n        type: 'inner'\n      });\n      walls.push({\n        x1: r.x,\n        y1: r.y + r.h,\n        x2: r.x + r.w,\n        y2: r.y + r.h,\n        type: 'inner'\n      });\n      walls.push({\n        x1: r.x,\n        y1: r.y,\n        x2: r.x,\n        y2: r.y + r.h,\n        type: 'inner'\n      });\n      walls.push({\n        x1: r.x + r.w,\n        y1: r.y,\n        x2: r.x + r.w,\n        y2: r.y + r.h,\n        type: 'inner'\n      });\n    });\n\n    // Outer Shell\n    const b = blackboard.read('siteBoundary');\n    const outer = [{\n      x1: b.x,\n      y1: b.y,\n      x2: b.x + b.w,\n      y2: b.y\n    }, {\n      x1: b.x,\n      y1: b.y + b.h,\n      x2: b.x + b.w,\n      y2: b.y + b.h\n    }, {\n      x1: b.x,\n      y1: b.y,\n      x2: b.x,\n      y2: b.y + b.h\n    }, {\n      x1: b.x + b.w,\n      y1: b.y,\n      x2: b.x + b.w,\n      y2: b.y + b.h\n    }];\n    allWalls.push({\n      inner: walls,\n      outer: outer\n    });\n  });\n  blackboard.write('floorWalls', allWalls);\n  return true;\n};\n\n// 4. Connectivity Agent (Doors)\n_c4 = StructuralAgent;\nconst ConnectivityAgent = async () => {\n  LOG('Checking access paths...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allDoors = [];\n  floorRegions.forEach((rooms, floorIndex) => {\n    const doors = [];\n    for (let i = 0; i < rooms.length; i++) {\n      for (let j = i + 1; j < rooms.length; j++) {\n        const r1 = rooms[i];\n        const r2 = rooms[j];\n\n        // Define shared borders\n        const touchingY = Math.abs(r1.y + r1.h - r2.y) < 0.1 || Math.abs(r2.y + r2.h - r1.y) < 0.1;\n        const touchingX = Math.abs(r1.x + r1.w - r2.x) < 0.1 || Math.abs(r2.x + r2.w - r1.x) < 0.1;\n\n        // Check overlap\n        const verticalOverlap = r1.x < r2.x + r2.w && r1.x + r1.w > r2.x;\n        const horizontalOverlap = r1.y < r2.y + r2.h && r1.y + r1.h > r2.y;\n\n        // Connections: Hallway OR Inter-room (e.g., Master -> Bath)\n        const isHall = r1.type === 'hallway' || r2.type === 'hallway';\n        const isEnsuite = r1.type.includes('bed') && r2.type === 'bathroom' || r2.type.includes('bed') && r1.type === 'bathroom';\n        if ((isHall || isEnsuite) && verticalOverlap && touchingY) {\n          const mid = (Math.max(r1.x, r2.x) + Math.min(r1.x + r1.w, r2.x + r2.w)) / 2;\n          doors.push({\n            x: mid - 1.5,\n            y: Math.abs(r1.y + r1.h - r2.y) < 0.1 ? r2.y : r1.y,\n            w: 3,\n            vertical: false\n          });\n        } else if ((isHall || isEnsuite) && horizontalOverlap && touchingX) {\n          const mid = (Math.max(r1.y, r2.y) + Math.min(r1.y + r1.h, r2.y + r2.h)) / 2;\n          doors.push({\n            x: Math.abs(r1.x + r1.w - r2.x) < 0.1 ? r2.x : r1.x,\n            y: mid - 1.5,\n            w: 3,\n            vertical: true\n          });\n        }\n      }\n    }\n    // Main Entry\n    if (floorIndex === 0) {\n      const hall = rooms.find(r => r.type === 'hallway');\n      if (hall) doors.push({\n        x: hall.x + hall.w / 2 - 2,\n        y: hall.y + hall.h,\n        w: 4,\n        vertical: false,\n        type: 'main'\n      });\n    }\n    allDoors.push(doors);\n  });\n  blackboard.write('floorDoors', allDoors);\n  return true;\n};\n_c5 = ConnectivityAgent;\nexport const agents = [{\n  name: 'Multi-Floor Allocator',\n  fn: RequirementAgent\n}, {\n  name: 'Layout Engine (Smart-Split)',\n  fn: LayoutAgent\n}, {\n  name: 'Structural Logic',\n  fn: StructuralAgent\n}, {\n  name: 'Access Grapher',\n  fn: ConnectivityAgent\n}];\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"LOG\");\n$RefreshReg$(_c2, \"RequirementAgent\");\n$RefreshReg$(_c3, \"LayoutAgent\");\n$RefreshReg$(_c4, \"StructuralAgent\");\n$RefreshReg$(_c5, \"ConnectivityAgent\");","map":{"version":3,"names":["blackboard","LOG","msg","console","log","_c","ROOM_WEIGHTS","ZONING_SCORE","SMALL_ROOMS","RequirementAgent","config","pad","buildW","width","buildD","depth","write","x","y","w","h","floorQueues","Array","from","length","floors","rooms","addToFloor","f","type","target","push","garage","kitchen","dining","living","forEach","bathroom","currentFloor","bedroom","library","_c2","LayoutAgent","bounds","read","allFloorsRegions","spineW","spineX","regions","hall","leftSpace","rightSpace","smartSlice","rect","roomList","sort","a","b","i","includes","bathIdx","findIndex","r","idx","bath","splice","effectiveList","current","next","items","weight","totalWeight","reduce","sum","item","currentY","rowHeight","w1","w2","leftRooms","rightRooms","pop","_c3","StructuralAgent","floorRegions","allWalls","walls","x1","y1","x2","y2","outer","inner","_c4","ConnectivityAgent","allDoors","floorIndex","doors","j","r1","r2","touchingY","Math","abs","touchingX","verticalOverlap","horizontalOverlap","isHall","isEnsuite","mid","max","min","vertical","find","_c5","agents","name","fn","$RefreshReg$"],"sources":["E:/PAP/SEM 5  (Current)/Agent Based Software Engineering (ABSE)/Schematic-Architecture-Generator/ShamArchitectSys_Final/src/agents/AgentSystem.js"],"sourcesContent":["import { blackboard } from '../core/Blackboard';\n\nconst LOG = (msg) => console.log(`[System] ${msg}`);\n\n// --- 0. ARCHITECTURAL RULES ---\n\n// 1. Room Sizing Weights (Relative Units)\nconst ROOM_WEIGHTS = {\n  'garage': 1.5,\n  'living': 1.8,  // Large\n  'dining': 1.2,\n  'kitchen': 1.3,\n  'master-bed': 1.6, // Spacious\n  'bedroom': 1.2,\n  'library': 1.0,\n  'study': 0.9,\n  'bathroom': 0.6, // Small\n  'prayer': 0.6,   // Small\n  'utility': 0.7,\n  'store': 0.4\n};\n\n// 2. Zoning Score (0 = Private/Back, 100 = Public/Front)\nconst ZONING_SCORE = {\n  'utility': 5,     \n  'store': 5,\n  'kitchen': 10,     \n  'dining': 15,\n  'study': 20,\n  'library': 25,\n  'master-bed': 30,  \n  'bedroom': 35,\n  'bathroom': 36,    \n  'prayer': 40,\n  'stairs': 50,      \n  'living': 80,      \n  'garage': 90,     \n  'hallway': 50\n};\n\n// 3. Definition of \"Small\" rooms suitable for side-by-side placement\nconst SMALL_ROOMS = ['bathroom', 'prayer', 'utility', 'store', 'study', 'library'];\n\n// --- AGENTS ---\n\n// 1. Requirement Agent (Distributes Rooms)\nconst RequirementAgent = async (config) => {\n  LOG('Analyzing room inventory...');\n  \n  const pad = 4;\n  const buildW = config.width - (pad*2);\n  const buildD = config.depth - (pad*2);\n\n  blackboard.write('config', config);\n  blackboard.write('siteBoundary', { x: pad, y: pad, w: buildW, h: buildD });\n  \n  const floorQueues = Array.from({ length: config.floors }, () => []);\n  const rooms = { ...config.rooms };\n  \n  const addToFloor = (f, type) => {\n    const target = (f < config.floors) ? f : config.floors - 1;\n    floorQueues[target].push(type);\n  };\n\n  // --- FLOOR 0: Public & Service ---\n  if (rooms.garage > 0) { addToFloor(0, 'garage'); rooms.garage--; }\n  if (rooms.kitchen > 0) { addToFloor(0, 'kitchen'); rooms.kitchen--; }\n  if (rooms.dining > 0) { addToFloor(0, 'dining'); rooms.dining--; }\n  if (rooms.living > 0) { addToFloor(0, 'living'); rooms.living--; }\n  \n  // Fill Small Service Rooms\n  ['utility', 'prayer', 'store'].forEach(type => {\n      while(rooms[type] > 0) { addToFloor(0, type); rooms[type]--; }\n  });\n\n  if (rooms.bathroom > 0) { addToFloor(0, 'bathroom'); rooms.bathroom--; }\n\n  // --- UPPER FLOORS: Private ---\n  let currentFloor = config.floors > 1 ? 1 : 0;\n\n  // Master Suite\n  if (rooms.bedroom > 0) {\n    addToFloor(currentFloor, 'master-bed'); \n    rooms.bedroom--;\n    if (rooms.bathroom > 0) { addToFloor(currentFloor, 'bathroom'); rooms.bathroom--; }\n  }\n\n  // Standard Beds\n  while (rooms.bedroom > 0) {\n    addToFloor(currentFloor, 'bedroom');\n    rooms.bedroom--;\n    if (rooms.bathroom > 0) { addToFloor(currentFloor, 'bathroom'); rooms.bathroom--; }\n    \n    // Distribute logic\n    if (config.floors > 2 && currentFloor < config.floors - 1) currentFloor++;\n    else if (config.floors > 1) currentFloor = 1;\n  }\n\n  // Library/Office\n  while (rooms.library > 0) {\n    addToFloor(config.floors > 1 ? 1 : 0, 'library');\n    rooms.library--;\n  }\n\n  blackboard.write('floorQueues', floorQueues);\n  return true;\n};\n\n// 2. Advanced Layout Agent (Smart Splitter)\nconst LayoutAgent = async () => {\n  LOG('Calculating Smart-Split layouts...');\n  const bounds = blackboard.read('siteBoundary');\n  const floorQueues = blackboard.read('floorQueues');\n  const config = blackboard.read('config');\n\n  const allFloorsRegions = [];\n  const spineW = 6;\n  const spineX = bounds.x + (bounds.w/2) - (spineW/2);\n  \n  for (let f = 0; f < config.floors; f++) {\n    const regions = [];\n    let rooms = floorQueues[f] || [];\n\n    // Fixed Elements\n    const hall = { x: spineX, y: bounds.y + 8, w: spineW, h: bounds.h - 12, type: 'hallway' };\n    regions.push(hall);\n\n    if (config.floors > 1) {\n      regions.push({ x: hall.x, y: hall.y + hall.h - 10, w: hall.w, h: 8, type: 'stairs' });\n    }\n\n    const leftSpace = { x: bounds.x, y: bounds.y, w: (bounds.w/2) - (spineW/2), h: bounds.h };\n    const rightSpace = { x: spineX + spineW, y: bounds.y, w: (bounds.w/2) - (spineW/2), h: bounds.h };\n\n    // --- THE SMART SLICER ---\n    const smartSlice = (rect, roomList) => {\n      if (roomList.length === 0) return;\n\n      // 1. Zoning Sort\n      roomList.sort((a, b) => (ZONING_SCORE[a] || 50) - (ZONING_SCORE[b] || 50));\n\n      // 2. Optimize: Move baths next to beds if scattered\n      for(let i=0; i<roomList.length-1; i++) {\n         if(roomList[i].includes('bed') && roomList[i+1] !== 'bathroom') {\n             const bathIdx = roomList.findIndex((r, idx) => idx > i && r === 'bathroom');\n             if(bathIdx !== -1) {\n                 const bath = roomList.splice(bathIdx, 1)[0];\n                 roomList.splice(i+1, 0, bath);\n             }\n         }\n      }\n\n      // 3. Pre-Calculate total \"Row Weights\" accounting for pairing\n      let effectiveList = [];\n      let i = 0;\n      while(i < roomList.length) {\n        const current = roomList[i];\n        const next = roomList[i+1];\n\n        // Check for Twin Pair Condition\n        if (next && SMALL_ROOMS.includes(current) && SMALL_ROOMS.includes(next)) {\n           // Create a \"Pair\" object\n           effectiveList.push({ type: 'PAIR', items: [current, next], weight: ROOM_WEIGHTS[current] + ROOM_WEIGHTS[next] });\n           i += 2;\n        } else {\n           effectiveList.push({ type: 'SINGLE', items: [current], weight: ROOM_WEIGHTS[current] || 1.0 });\n           i += 1;\n        }\n      }\n\n      const totalWeight = effectiveList.reduce((sum, item) => sum + item.weight, 0);\n      let currentY = rect.y;\n\n      // 4. Render Rows\n      effectiveList.forEach(item => {\n        const rowHeight = (item.weight / totalWeight) * rect.h;\n        \n        if (item.type === 'SINGLE') {\n          // Standard Room\n          regions.push({ \n            x: rect.x, y: currentY, w: rect.w, h: rowHeight, type: item.items[0] \n          });\n        } else {\n          // Twin Pair (Side-by-Side Split)\n          const w1 = rect.w * 0.5;\n          const w2 = rect.w - w1;\n          \n          regions.push({ \n            x: rect.x, y: currentY, w: w1, h: rowHeight, type: item.items[0] \n          });\n          regions.push({ \n            x: rect.x + w1, y: currentY, w: w2, h: rowHeight, type: item.items[1] \n          });\n        }\n        currentY += rowHeight;\n      });\n    };\n\n    // Assign Sides\n    const leftRooms = [];\n    const rightRooms = [];\n    \n    rooms.forEach(r => {\n      if(['garage','kitchen','dining','utility','prayer','store'].includes(r)) rightRooms.push(r);\n      else leftRooms.push(r);\n    });\n\n    // Balance Check\n    if(leftRooms.length === 0 && rightRooms.length > 1) leftRooms.push(rightRooms.pop());\n    if(rightRooms.length === 0 && leftRooms.length > 1) rightRooms.push(leftRooms.pop());\n\n    smartSlice(leftSpace, leftRooms);\n    smartSlice(rightSpace, rightRooms);\n    \n    allFloorsRegions.push(regions);\n  }\n\n  blackboard.write('floorRegions', allFloorsRegions);\n  return true;\n};\n\n// 3. Structural Agent (Walls)\nconst StructuralAgent = async () => {\n  LOG('Aligning structure...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allWalls = [];\n\n  floorRegions.forEach((rooms) => {\n    const walls = [];\n    rooms.forEach(r => {\n      // Box walls for every room\n      walls.push({ x1: r.x, y1: r.y, x2: r.x+r.w, y2: r.y, type: 'inner' });\n      walls.push({ x1: r.x, y1: r.y+r.h, x2: r.x+r.w, y2: r.y+r.h, type: 'inner' });\n      walls.push({ x1: r.x, y1: r.y, x2: r.x, y2: r.y+r.h, type: 'inner' });\n      walls.push({ x1: r.x+r.w, y1: r.y, x2: r.x+r.w, y2: r.y+r.h, type: 'inner' });\n    });\n    \n    // Outer Shell\n    const b = blackboard.read('siteBoundary');\n    const outer = [\n      { x1: b.x, y1: b.y, x2: b.x+b.w, y2: b.y },\n      { x1: b.x, y1: b.y+b.h, x2: b.x+b.w, y2: b.y+b.h },\n      { x1: b.x, y1: b.y, x2: b.x, y2: b.y+b.h },\n      { x1: b.x+b.w, y1: b.y, x2: b.x+b.w, y2: b.y+b.h },\n    ];\n    allWalls.push({ inner: walls, outer: outer });\n  });\n\n  blackboard.write('floorWalls', allWalls);\n  return true;\n};\n\n// 4. Connectivity Agent (Doors)\nconst ConnectivityAgent = async () => {\n  LOG('Checking access paths...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allDoors = [];\n\n  floorRegions.forEach((rooms, floorIndex) => {\n    const doors = [];\n    for (let i = 0; i < rooms.length; i++) {\n      for (let j = i + 1; j < rooms.length; j++) {\n        const r1 = rooms[i];\n        const r2 = rooms[j];\n        \n        // Define shared borders\n        const touchingY = Math.abs(r1.y + r1.h - r2.y) < 0.1 || Math.abs(r2.y + r2.h - r1.y) < 0.1;\n        const touchingX = Math.abs(r1.x + r1.w - r2.x) < 0.1 || Math.abs(r2.x + r2.w - r1.x) < 0.1;\n\n        // Check overlap\n        const verticalOverlap = (r1.x < r2.x + r2.w && r1.x + r1.w > r2.x);\n        const horizontalOverlap = (r1.y < r2.y + r2.h && r1.y + r1.h > r2.y);\n\n        // Connections: Hallway OR Inter-room (e.g., Master -> Bath)\n        const isHall = r1.type === 'hallway' || r2.type === 'hallway';\n        const isEnsuite = (r1.type.includes('bed') && r2.type === 'bathroom') || (r2.type.includes('bed') && r1.type === 'bathroom');\n\n        if ((isHall || isEnsuite) && verticalOverlap && touchingY) {\n             const mid = (Math.max(r1.x, r2.x) + Math.min(r1.x+r1.w, r2.x+r2.w)) / 2;\n             doors.push({ x: mid - 1.5, y: (Math.abs(r1.y+r1.h - r2.y) < 0.1 ? r2.y : r1.y), w: 3, vertical: false });\n        } \n        else if ((isHall || isEnsuite) && horizontalOverlap && touchingX) {\n             const mid = (Math.max(r1.y, r2.y) + Math.min(r1.y+r1.h, r2.y+r2.h)) / 2;\n             doors.push({ x: (Math.abs(r1.x+r1.w - r2.x) < 0.1 ? r2.x : r1.x), y: mid - 1.5, w: 3, vertical: true });\n        }\n      }\n    }\n    // Main Entry\n    if (floorIndex === 0) {\n      const hall = rooms.find(r => r.type === 'hallway');\n      if(hall) doors.push({ x: hall.x + (hall.w/2) - 2, y: hall.y + hall.h, w: 4, vertical: false, type: 'main' });\n    }\n    allDoors.push(doors);\n  });\n\n  blackboard.write('floorDoors', allDoors);\n  return true;\n};\n\nexport const agents = [\n  { name: 'Multi-Floor Allocator', fn: RequirementAgent },\n  { name: 'Layout Engine (Smart-Split)', fn: LayoutAgent },\n  { name: 'Structural Logic', fn: StructuralAgent },\n  { name: 'Access Grapher', fn: ConnectivityAgent },\n];"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}