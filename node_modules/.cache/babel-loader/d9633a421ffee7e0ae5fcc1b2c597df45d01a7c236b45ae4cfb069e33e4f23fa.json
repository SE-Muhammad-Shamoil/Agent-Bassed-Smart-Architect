{"ast":null,"code":"import { blackboard } from '../core/Blackboard';\n\n/**\n * ==================================================================================\n * SHAM ARCHITECT SYS - PRO GEN 6.1 (BUG FIX PATCH)\n * ==================================================================================\n * Fix: Added missing config write to Blackboard prevents crash on Layout.\n */\n\nconst LOG = msg => console.log(`[Architect Core] ${msg}`);\n\n// ==================================================================================\n// 1. ARCHITECTURAL KNOWLEDGE BASE\n// ==================================================================================\n_c = LOG;\nconst ROOM_SPECS = {\n  // Weights determine relative height/size of the room in the stack\n  'living': {\n    weight: 2.2,\n    minDim: 14,\n    color: '#fff7ed',\n    label: 'Living Room'\n  },\n  'dining': {\n    weight: 1.4,\n    minDim: 11,\n    color: '#fffbeb',\n    label: 'Dining'\n  },\n  'garage': {\n    weight: 2.0,\n    minDim: 12,\n    color: '#f1f5f9',\n    label: 'Garage'\n  },\n  'kitchen': {\n    weight: 1.5,\n    minDim: 11,\n    color: '#ecfeff',\n    label: 'Kitchen'\n  },\n  'master-bed': {\n    weight: 1.8,\n    minDim: 13,\n    color: '#f0f9ff',\n    label: 'Master Suite'\n  },\n  'bedroom': {\n    weight: 1.3,\n    minDim: 10,\n    color: '#f0f9ff',\n    label: 'Bedroom'\n  },\n  'study': {\n    weight: 1.0,\n    minDim: 9,\n    color: '#fefce8',\n    label: 'Study'\n  },\n  'library': {\n    weight: 1.2,\n    minDim: 10,\n    color: '#fefce8',\n    label: 'Library'\n  },\n  'bathroom': {\n    weight: 0.8,\n    minDim: 6,\n    color: '#f8fafc',\n    label: 'Bath'\n  },\n  'utility': {\n    weight: 0.9,\n    minDim: 7,\n    color: '#f3f4f6',\n    label: 'Laundry'\n  },\n  'prayer': {\n    weight: 0.8,\n    minDim: 7,\n    color: '#f0fdf4',\n    label: 'Prayer'\n  },\n  'store': {\n    weight: 0.5,\n    minDim: 5,\n    color: '#cbd5e1',\n    label: 'Store'\n  },\n  'hallway': {\n    weight: 0,\n    minDim: 4,\n    color: '#ffffff',\n    label: 'Hallway'\n  },\n  'stairs': {\n    weight: 0,\n    minDim: 8,\n    color: '#e2e8f0',\n    label: 'Stairs'\n  }\n};\n\n// ==================================================================================\n// 2. GEOMETRY ENGINE\n// ==================================================================================\n\nclass Rect {\n  constructor(x, y, w, h) {\n    this.x = x;\n    this.y = y;\n    this.w = w;\n    this.h = h;\n  }\n  get right() {\n    return this.x + this.w;\n  }\n  get bottom() {\n    return this.y + this.h;\n  }\n}\n\n// ==================================================================================\n// 3. AGENT IMPLEMENTATIONS\n// ==================================================================================\n\n// --- AGENT 1: ZONING (Assigns Logic) ---\nconst ZoningAgent = async config => {\n  LOG('Zoning rooms with direct-access priority...');\n\n  // FIX: Write config to blackboard so other agents can read it\n  blackboard.write('config', config);\n  const pad = 4;\n  const buildW = config.width - pad * 2;\n  const buildD = config.depth - pad * 2;\n  blackboard.write('siteBoundary', new Rect(pad, pad, buildW, buildD));\n  const inventory = {\n    ...config.rooms\n  };\n  const floorPlans = Array.from({\n    length: config.floors\n  }, () => ({\n    clusters: []\n  }));\n  const assign = (fIdx, cluster) => {\n    const f = Math.min(fIdx, config.floors - 1);\n    floorPlans[f].clusters.push(cluster);\n  };\n\n  // 1. Master Suite (Priority 1)\n  if (inventory.bedroom > 0) {\n    const cluster = {\n      type: 'SUITE',\n      main: 'master-bed',\n      subs: [],\n      id: 'master'\n    };\n    inventory.bedroom--;\n    if (inventory.bathroom > 0) {\n      cluster.subs.push('bathroom');\n      inventory.bathroom--;\n    }\n    assign(config.floors > 1 ? 1 : 0, cluster);\n  }\n\n  // 2. Standard Bedrooms\n  let curF = config.floors > 1 ? 1 : 0;\n  while (inventory.bedroom > 0) {\n    const cluster = {\n      type: 'ROOM',\n      main: 'bedroom',\n      subs: [],\n      id: `bed-${inventory.bedroom}`\n    };\n    inventory.bedroom--;\n    if (inventory.bathroom > 0 && Math.random() > 0.5) {\n      cluster.type = 'SUITE';\n      cluster.subs.push('bathroom');\n      inventory.bathroom--;\n    }\n    assign(curF, cluster);\n    if (config.floors > 2 && curF < config.floors - 1) curF++;else if (config.floors > 1) curF = 1;\n  }\n\n  // 3. Ground Floor Core\n  assign(0, {\n    type: 'ROOM',\n    main: 'kitchen',\n    subs: [],\n    id: 'kitchen'\n  });\n  if (inventory.dining > 0) assign(0, {\n    type: 'ROOM',\n    main: 'dining',\n    subs: [],\n    id: 'dining'\n  });\n  assign(0, {\n    type: 'ROOM',\n    main: 'living',\n    subs: [],\n    id: 'living'\n  });\n  if (inventory.garage > 0) assign(0, {\n    type: 'ROOM',\n    main: 'garage',\n    subs: [],\n    id: 'garage'\n  });\n\n  // 4. Remaining Items\n  const leftovers = ['bathroom', 'utility', 'prayer', 'library', 'study', 'store'];\n  leftovers.forEach(type => {\n    while (inventory[type] > 0) {\n      assign(0, {\n        type: 'ROOM',\n        main: type,\n        subs: [],\n        id: `${type}-shared`\n      });\n      inventory[type]--;\n    }\n  });\n  blackboard.write('floorPlans', floorPlans);\n  return true;\n};\n\n// --- AGENT 2: LAYOUT SOLVER (The Spine Stacker) ---\n_c2 = ZoningAgent;\nconst LayoutAgent = async () => {\n  LOG('Solving layout with Spine-Anchored Stacking...');\n  const site = blackboard.read('siteBoundary');\n  const floorPlans = blackboard.read('floorPlans');\n  const config = blackboard.read('config'); // This should now work\n  const allFloorsRegions = [];\n  const SPINE_W = 6;\n  const SPINE_X = site.x + (site.w - SPINE_W) / 2;\n  floorPlans.forEach((plan, floorIdx) => {\n    const regions = [];\n\n    // 1. Establish Spine\n    const hallRect = new Rect(SPINE_X, site.y + 6, SPINE_W, site.h - 10);\n    regions.push({\n      ...hallRect,\n      type: 'hallway'\n    });\n    if (config.floors > 1) {\n      regions.push({\n        x: SPINE_X,\n        y: hallRect.bottom - 10,\n        w: SPINE_W,\n        h: 10,\n        type: 'stairs'\n      });\n      hallRect.h -= 10;\n    }\n\n    // 2. Define Wings\n    const leftWing = {\n      x: site.x,\n      y: site.y,\n      w: (site.w - SPINE_W) / 2,\n      h: site.h\n    };\n    const rightWing = {\n      x: SPINE_X + SPINE_W,\n      y: site.y,\n      w: (site.w - SPINE_W) / 2,\n      h: site.h\n    };\n\n    // 3. Sort Clusters\n    const getScore = c => {\n      const name = c.main;\n      if (name.includes('kitchen') || name.includes('master')) return 0; // Rear\n      if (name.includes('dining') || name.includes('utility')) return 20;\n      if (name.includes('bed')) return 30;\n      if (name.includes('living')) return 80;\n      if (name.includes('garage')) return 90; // Front\n      return 50;\n    };\n    const leftClusters = [];\n    const rightClusters = [];\n    plan.clusters.sort((a, b) => getScore(a) - getScore(b));\n    plan.clusters.forEach(c => {\n      if (c.main === 'garage') rightClusters.push(c);else if (c.main === 'kitchen') leftClusters.push(c);else if (c.main === 'living') leftClusters.push(c);else if (c.main === 'dining') leftClusters.push(c);else {\n        if (leftClusters.length <= rightClusters.length) leftClusters.push(c);else rightClusters.push(c);\n      }\n    });\n\n    // 4. Stack Algorithm\n    const stackWing = (wingRect, clusters, side) => {\n      if (clusters.length === 0) return;\n      const totalW = clusters.reduce((sum, c) => {\n        var _ROOM_SPECS$c$main;\n        return sum + (((_ROOM_SPECS$c$main = ROOM_SPECS[c.main]) === null || _ROOM_SPECS$c$main === void 0 ? void 0 : _ROOM_SPECS$c$main.weight) || 1);\n      }, 0);\n      let currentY = wingRect.y;\n      clusters.forEach(c => {\n        const spec = ROOM_SPECS[c.main] || {\n          weight: 1\n        };\n        const rowH = spec.weight / totalW * wingRect.h;\n        const rowRect = new Rect(wingRect.x, currentY, wingRect.w, rowH);\n        if (c.type === 'SUITE' && c.subs.length > 0) {\n          const bathW = rowRect.w * 0.35;\n          const bedW = rowRect.w - bathW;\n          if (side === 'LEFT') {\n            regions.push({\n              x: rowRect.x,\n              y: currentY,\n              w: bathW,\n              h: rowH,\n              type: c.subs[0]\n            });\n            regions.push({\n              x: rowRect.x + bathW,\n              y: currentY,\n              w: bedW,\n              h: rowH,\n              type: c.main\n            });\n          } else {\n            regions.push({\n              x: rowRect.x,\n              y: currentY,\n              w: bedW,\n              h: rowH,\n              type: c.main\n            });\n            regions.push({\n              x: rowRect.x + bedW,\n              y: currentY,\n              w: bathW,\n              h: rowH,\n              type: c.subs[0]\n            });\n          }\n        } else {\n          regions.push({\n            ...rowRect,\n            type: c.main\n          });\n        }\n        currentY += rowH;\n      });\n    };\n    stackWing(leftWing, leftClusters, 'LEFT');\n    stackWing(rightWing, rightClusters, 'RIGHT');\n    allFloorsRegions.push(regions);\n  });\n  blackboard.write('floorRegions', allFloorsRegions);\n  return true;\n};\n\n// --- AGENT 3: STRUCTURAL ---\n_c3 = LayoutAgent;\nconst StructuralAgent = async () => {\n  LOG('Building Walls...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allWalls = [];\n  floorRegions.forEach(rooms => {\n    const walls = [];\n    rooms.forEach(r => {\n      walls.push({\n        x1: r.x,\n        y1: r.y,\n        x2: r.x + r.w,\n        y2: r.y,\n        type: 'inner'\n      });\n      walls.push({\n        x1: r.x,\n        y1: r.y + r.h,\n        x2: r.x + r.w,\n        y2: r.y + r.h,\n        type: 'inner'\n      });\n      walls.push({\n        x1: r.x,\n        y1: r.y,\n        x2: r.x,\n        y2: r.y + r.h,\n        type: 'inner'\n      });\n      walls.push({\n        x1: r.x + r.w,\n        y1: r.y,\n        x2: r.x + r.w,\n        y2: r.y + r.h,\n        type: 'inner'\n      });\n    });\n    const b = blackboard.read('siteBoundary');\n    const outer = [{\n      x1: b.x,\n      y1: b.y,\n      x2: b.x + b.w,\n      y2: b.y\n    }, {\n      x1: b.x,\n      y1: b.y + b.h,\n      x2: b.x + b.w,\n      y2: b.y + b.h\n    }, {\n      x1: b.x,\n      y1: b.y,\n      x2: b.x,\n      y2: b.y + b.h\n    }, {\n      x1: b.x + b.w,\n      y1: b.y,\n      x2: b.x + b.w,\n      y2: b.y + b.h\n    }];\n    allWalls.push({\n      inner: walls,\n      outer: outer\n    });\n  });\n  blackboard.write('floorWalls', allWalls);\n  return true;\n};\n\n// --- AGENT 4: DOORS ---\n_c4 = StructuralAgent;\nconst ConnectivityAgent = async () => {\n  LOG('Placing Doors...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allDoors = [];\n  floorRegions.forEach((rooms, floorIndex) => {\n    const doors = [];\n    const addDoor = d => {\n      if (!doors.some(x => Math.abs(x.x - d.x) < 1 && Math.abs(x.y - d.y) < 1)) doors.push(d);\n    };\n    rooms.forEach((r1, i) => {\n      rooms.forEach((r2, j) => {\n        if (i <= j) return;\n        const overlapX = Math.min(r1.x + r1.w, r2.x + r2.w) - Math.max(r1.x, r2.x);\n        const overlapY = Math.min(r1.y + r1.h, r2.y + r2.h) - Math.max(r1.y, r2.y);\n        const touchX = Math.abs(r1.x + r1.w - r2.x) < 0.1 || Math.abs(r2.x + r2.w - r1.x) < 0.1;\n        const touchY = Math.abs(r1.y + r1.h - r2.y) < 0.1 || Math.abs(r2.y + r2.h - r1.y) < 0.1;\n        const r1Hall = r1.type === 'hallway';\n        const r2Hall = r2.type === 'hallway';\n        if (r1Hall || r2Hall) {\n          if (touchX && overlapY > 3) addDoor({\n            x: r1.x < r2.x ? r2.x : r1.x,\n            y: Math.max(r1.y, r2.y) + overlapY / 2 - 1.5,\n            w: 3,\n            vertical: true\n          });else if (touchY && overlapX > 3) addDoor({\n            x: Math.max(r1.x, r2.x) + overlapX / 2 - 1.5,\n            y: r1.y < r2.y ? r2.y : r1.y,\n            w: 3,\n            vertical: false\n          });\n        }\n        const r1Bath = r1.type === 'bathroom';\n        const r2Bath = r2.type === 'bathroom';\n        const r1Bed = r1.type.includes('bed');\n        const r2Bed = r2.type.includes('bed');\n        if (r1Bath && r2Bed || r2Bath && r1Bed) {\n          if (touchX && overlapY > 3) addDoor({\n            x: r1.x < r2.x ? r2.x : r1.x,\n            y: Math.max(r1.y, r2.y) + overlapY / 2 - 1.5,\n            w: 3,\n            vertical: true\n          });\n        }\n      });\n    });\n    if (floorIndex === 0) {\n      const hall = rooms.find(r => r.type === 'hallway');\n      if (hall) addDoor({\n        x: hall.x + hall.w / 2 - 2,\n        y: hall.y + hall.h,\n        w: 4,\n        vertical: false\n      });\n    }\n    allDoors.push(doors);\n  });\n  blackboard.write('floorDoors', allDoors);\n  return true;\n};\n\n// ... existing agents ...\n\n// --- AGENT 5: INTERIOR DESIGNER ---\n_c5 = ConnectivityAgent;\nconst InteriorAgent = async () => {\n  LOG('Arranging Interior Furniture...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allFurniture = [];\n  floorRegions.forEach(rooms => {\n    const floorItems = [];\n    rooms.forEach(r => {\n      const cx = r.x + r.w / 2;\n      const cy = r.y + r.h / 2;\n\n      // Helper to ensure furniture stays inside bounds\n      const safeW = val => Math.min(val, r.w - 2);\n      const safeH = val => Math.min(val, r.h - 2);\n      switch (true) {\n        case r.type.includes('bed'):\n          const isMaster = r.type === 'master-bed';\n          const bedW = isMaster ? 6 : 4;\n          const bedH = 6;\n          // Place bed against the \"top\" wall of the room\n          floorItems.push({\n            type: 'bed',\n            x: cx - bedW / 2,\n            y: r.y + 1.5,\n            w: bedW,\n            h: bedH\n          });\n          // Pillows\n          floorItems.push({\n            type: 'pillow',\n            x: cx - bedW / 2 + 0.5,\n            y: r.y + 2,\n            w: 1.5,\n            h: 1\n          });\n          if (isMaster) floorItems.push({\n            type: 'pillow',\n            x: cx + bedW / 2 - 2,\n            y: r.y + 2,\n            w: 1.5,\n            h: 1\n          });\n\n          // Wardrobe (side wall)\n          floorItems.push({\n            type: 'storage',\n            x: r.x + 0.5,\n            y: r.y + 1,\n            w: 2,\n            h: r.h / 2\n          });\n          break;\n        case r.type === 'living':\n          // L-Shaped Sofa approximation (Main piece + side piece)\n          floorItems.push({\n            type: 'sofa',\n            x: r.x + 2,\n            y: r.y + 2,\n            w: 2.5,\n            h: 8\n          }); // Vertical back\n          floorItems.push({\n            type: 'sofa',\n            x: r.x + 2,\n            y: r.y + 2,\n            w: 8,\n            h: 2.5\n          }); // Horizontal back\n          // Coffee Table\n          floorItems.push({\n            type: 'table',\n            x: r.x + 5.5,\n            y: r.y + 5.5,\n            w: 4,\n            h: 3\n          });\n          // TV Stand (Opposite wall)\n          floorItems.push({\n            type: 'storage',\n            x: r.x + r.w - 2,\n            y: cy - 4,\n            w: 1.5,\n            h: 8\n          });\n          break;\n        case r.type === 'dining':\n          // Large Table\n          floorItems.push({\n            type: 'table',\n            x: cx - 3,\n            y: cy - 4,\n            w: 6,\n            h: 8\n          });\n          // Chairs (visual dots)\n          floorItems.push({\n            type: 'chair',\n            x: cx - 4,\n            y: cy - 2,\n            w: 1,\n            h: 1\n          });\n          floorItems.push({\n            type: 'chair',\n            x: cx + 3,\n            y: cy - 2,\n            w: 1,\n            h: 1\n          });\n          floorItems.push({\n            type: 'chair',\n            x: cx - 4,\n            y: cy + 1,\n            w: 1,\n            h: 1\n          });\n          floorItems.push({\n            type: 'chair',\n            x: cx + 3,\n            y: cy + 1,\n            w: 1,\n            h: 1\n          });\n          break;\n        case r.type === 'kitchen':\n          // Countertops along the edges\n          floorItems.push({\n            type: 'counter',\n            x: r.x,\n            y: r.y,\n            w: r.w,\n            h: 2\n          }); // Top\n          floorItems.push({\n            type: 'counter',\n            x: r.x,\n            y: r.y,\n            w: 2,\n            h: r.h\n          }); // Left\n          // Island\n          if (r.w > 10 && r.h > 10) {\n            floorItems.push({\n              type: 'counter',\n              x: cx - 2,\n              y: cy - 2,\n              w: 4,\n              h: 4\n            });\n          }\n          break;\n        case r.type === 'bathroom':\n          // Corner Shower\n          floorItems.push({\n            type: 'counter',\n            x: r.x,\n            y: r.y,\n            w: 3,\n            h: 3\n          });\n          // Sink\n          floorItems.push({\n            type: 'fixture',\n            x: r.x,\n            y: r.y + 4,\n            w: 2,\n            h: 2\n          });\n          break;\n        case r.type === 'study' || r.type === 'library':\n          // Desk\n          floorItems.push({\n            type: 'table',\n            x: r.x + 1,\n            y: r.y + 1,\n            w: 2.5,\n            h: 6\n          });\n          break;\n      }\n    });\n    allFurniture.push(floorItems);\n  });\n  blackboard.write('floorFurniture', allFurniture);\n  return true;\n};\n_c6 = InteriorAgent;\nexport const agents = [{\n  name: 'Zoning & Logic',\n  fn: ZoningAgent\n}, {\n  name: 'Spine-Stacker Layout',\n  fn: LayoutAgent\n}, {\n  name: 'Structural Skeleton',\n  fn: StructuralAgent\n}, {\n  name: 'Interior Designer',\n  fn: InteriorAgent\n},\n// <--- Added here\n{\n  name: 'Access Grapher',\n  fn: ConnectivityAgent\n}];\nvar _c, _c2, _c3, _c4, _c5, _c6;\n$RefreshReg$(_c, \"LOG\");\n$RefreshReg$(_c2, \"ZoningAgent\");\n$RefreshReg$(_c3, \"LayoutAgent\");\n$RefreshReg$(_c4, \"StructuralAgent\");\n$RefreshReg$(_c5, \"ConnectivityAgent\");\n$RefreshReg$(_c6, \"InteriorAgent\");","map":{"version":3,"names":["blackboard","LOG","msg","console","log","_c","ROOM_SPECS","weight","minDim","color","label","Rect","constructor","x","y","w","h","right","bottom","ZoningAgent","config","write","pad","buildW","width","buildD","depth","inventory","rooms","floorPlans","Array","from","length","floors","clusters","assign","fIdx","cluster","f","Math","min","push","bedroom","type","main","subs","id","bathroom","curF","random","dining","garage","leftovers","forEach","_c2","LayoutAgent","site","read","allFloorsRegions","SPINE_W","SPINE_X","plan","floorIdx","regions","hallRect","leftWing","rightWing","getScore","c","name","includes","leftClusters","rightClusters","sort","a","b","stackWing","wingRect","side","totalW","reduce","sum","_ROOM_SPECS$c$main","currentY","spec","rowH","rowRect","bathW","bedW","_c3","StructuralAgent","floorRegions","allWalls","walls","r","x1","y1","x2","y2","outer","inner","_c4","ConnectivityAgent","allDoors","floorIndex","doors","addDoor","d","some","abs","r1","i","r2","j","overlapX","max","overlapY","touchX","touchY","r1Hall","r2Hall","vertical","r1Bath","r2Bath","r1Bed","r2Bed","hall","find","_c5","InteriorAgent","allFurniture","floorItems","cx","cy","safeW","val","safeH","isMaster","bedH","_c6","agents","fn","$RefreshReg$"],"sources":["E:/PAP/SEM 5  (Current)/Agent Based Software Engineering (ABSE)/Schematic-Architecture-Generator/ShamArchitectSys_Final/src/agents/AgentSystem.js"],"sourcesContent":["import { blackboard } from '../core/Blackboard';\n\n/**\n * ==================================================================================\n * SHAM ARCHITECT SYS - PRO GEN 6.1 (BUG FIX PATCH)\n * ==================================================================================\n * Fix: Added missing config write to Blackboard prevents crash on Layout.\n */\n\nconst LOG = (msg) => console.log(`[Architect Core] ${msg}`);\n\n// ==================================================================================\n// 1. ARCHITECTURAL KNOWLEDGE BASE\n// ==================================================================================\n\nconst ROOM_SPECS = {\n  // Weights determine relative height/size of the room in the stack\n  'living':     { weight: 2.2, minDim: 14, color: '#fff7ed', label: 'Living Room' },\n  'dining':     { weight: 1.4, minDim: 11, color: '#fffbeb', label: 'Dining' },\n  'garage':     { weight: 2.0, minDim: 12, color: '#f1f5f9', label: 'Garage' },\n  'kitchen':    { weight: 1.5, minDim: 11, color: '#ecfeff', label: 'Kitchen' },\n  'master-bed': { weight: 1.8, minDim: 13, color: '#f0f9ff', label: 'Master Suite' },\n  'bedroom':    { weight: 1.3, minDim: 10, color: '#f0f9ff', label: 'Bedroom' },\n  'study':      { weight: 1.0, minDim: 9,  color: '#fefce8', label: 'Study' },\n  'library':    { weight: 1.2, minDim: 10, color: '#fefce8', label: 'Library' },\n  'bathroom':   { weight: 0.8, minDim: 6,  color: '#f8fafc', label: 'Bath' }, \n  'utility':    { weight: 0.9, minDim: 7,  color: '#f3f4f6', label: 'Laundry' },\n  'prayer':     { weight: 0.8, minDim: 7,  color: '#f0fdf4', label: 'Prayer' },\n  'store':      { weight: 0.5, minDim: 5,  color: '#cbd5e1', label: 'Store' },\n  'hallway':    { weight: 0,   minDim: 4,  color: '#ffffff', label: 'Hallway' },\n  'stairs':     { weight: 0,   minDim: 8,  color: '#e2e8f0', label: 'Stairs' }\n};\n\n// ==================================================================================\n// 2. GEOMETRY ENGINE\n// ==================================================================================\n\nclass Rect {\n  constructor(x, y, w, h) {\n    this.x = x; this.y = y; this.w = w; this.h = h;\n  }\n  get right() { return this.x + this.w; }\n  get bottom() { return this.y + this.h; }\n}\n\n// ==================================================================================\n// 3. AGENT IMPLEMENTATIONS\n// ==================================================================================\n\n// --- AGENT 1: ZONING (Assigns Logic) ---\nconst ZoningAgent = async (config) => {\n  LOG('Zoning rooms with direct-access priority...');\n  \n  // FIX: Write config to blackboard so other agents can read it\n  blackboard.write('config', config);\n\n  const pad = 4;\n  const buildW = config.width - (pad*2);\n  const buildD = config.depth - (pad*2);\n  blackboard.write('siteBoundary', new Rect(pad, pad, buildW, buildD));\n  \n  const inventory = { ...config.rooms };\n  const floorPlans = Array.from({ length: config.floors }, () => ({ clusters: [] }));\n\n  const assign = (fIdx, cluster) => {\n    const f = Math.min(fIdx, config.floors - 1);\n    floorPlans[f].clusters.push(cluster);\n  };\n\n  // 1. Master Suite (Priority 1)\n  if (inventory.bedroom > 0) {\n    const cluster = { type: 'SUITE', main: 'master-bed', subs: [], id: 'master' };\n    inventory.bedroom--;\n    if (inventory.bathroom > 0) { cluster.subs.push('bathroom'); inventory.bathroom--; }\n    assign(config.floors > 1 ? 1 : 0, cluster);\n  }\n\n  // 2. Standard Bedrooms\n  let curF = config.floors > 1 ? 1 : 0;\n  while (inventory.bedroom > 0) {\n    const cluster = { type: 'ROOM', main: 'bedroom', subs: [], id: `bed-${inventory.bedroom}` };\n    inventory.bedroom--;\n    if (inventory.bathroom > 0 && Math.random() > 0.5) {\n       cluster.type = 'SUITE';\n       cluster.subs.push('bathroom');\n       inventory.bathroom--;\n    }\n    assign(curF, cluster);\n    \n    if (config.floors > 2 && curF < config.floors - 1) curF++;\n    else if (config.floors > 1) curF = 1;\n  }\n\n  // 3. Ground Floor Core\n  assign(0, { type: 'ROOM', main: 'kitchen', subs: [], id: 'kitchen' });\n  if (inventory.dining > 0) assign(0, { type: 'ROOM', main: 'dining', subs: [], id: 'dining' });\n  assign(0, { type: 'ROOM', main: 'living', subs: [], id: 'living' });\n  if (inventory.garage > 0) assign(0, { type: 'ROOM', main: 'garage', subs: [], id: 'garage' });\n\n  // 4. Remaining Items\n  const leftovers = ['bathroom', 'utility', 'prayer', 'library', 'study', 'store'];\n  leftovers.forEach(type => {\n    while (inventory[type] > 0) {\n      assign(0, { type: 'ROOM', main: type, subs: [], id: `${type}-shared` });\n      inventory[type]--;\n    }\n  });\n\n  blackboard.write('floorPlans', floorPlans);\n  return true;\n};\n\n// --- AGENT 2: LAYOUT SOLVER (The Spine Stacker) ---\nconst LayoutAgent = async () => {\n  LOG('Solving layout with Spine-Anchored Stacking...');\n  \n  const site = blackboard.read('siteBoundary');\n  const floorPlans = blackboard.read('floorPlans');\n  const config = blackboard.read('config'); // This should now work\n  const allFloorsRegions = [];\n\n  const SPINE_W = 6;\n  const SPINE_X = site.x + (site.w - SPINE_W) / 2;\n\n  floorPlans.forEach((plan, floorIdx) => {\n    const regions = [];\n    \n    // 1. Establish Spine\n    const hallRect = new Rect(SPINE_X, site.y + 6, SPINE_W, site.h - 10);\n    regions.push({ ...hallRect, type: 'hallway' });\n    \n    if (config.floors > 1) {\n       regions.push({ x: SPINE_X, y: hallRect.bottom - 10, w: SPINE_W, h: 10, type: 'stairs' });\n       hallRect.h -= 10;\n    }\n\n    // 2. Define Wings\n    const leftWing = { x: site.x, y: site.y, w: (site.w - SPINE_W)/2, h: site.h };\n    const rightWing = { x: SPINE_X + SPINE_W, y: site.y, w: (site.w - SPINE_W)/2, h: site.h };\n\n    // 3. Sort Clusters\n    const getScore = (c) => {\n       const name = c.main;\n       if (name.includes('kitchen') || name.includes('master')) return 0; // Rear\n       if (name.includes('dining') || name.includes('utility')) return 20;\n       if (name.includes('bed')) return 30;\n       if (name.includes('living')) return 80;\n       if (name.includes('garage')) return 90; // Front\n       return 50;\n    };\n\n    const leftClusters = [];\n    const rightClusters = [];\n    \n    plan.clusters.sort((a,b) => getScore(a) - getScore(b));\n    \n    plan.clusters.forEach((c) => {\n      if (c.main === 'garage') rightClusters.push(c);\n      else if (c.main === 'kitchen') leftClusters.push(c); \n      else if (c.main === 'living') leftClusters.push(c); \n      else if (c.main === 'dining') leftClusters.push(c);\n      else {\n         if (leftClusters.length <= rightClusters.length) leftClusters.push(c);\n         else rightClusters.push(c);\n      }\n    });\n\n    // 4. Stack Algorithm\n    const stackWing = (wingRect, clusters, side) => {\n       if (clusters.length === 0) return;\n       \n       const totalW = clusters.reduce((sum, c) => sum + (ROOM_SPECS[c.main]?.weight || 1), 0);\n       let currentY = wingRect.y;\n\n       clusters.forEach(c => {\n          const spec = ROOM_SPECS[c.main] || { weight: 1 };\n          const rowH = (spec.weight / totalW) * wingRect.h;\n          const rowRect = new Rect(wingRect.x, currentY, wingRect.w, rowH);\n          \n          if (c.type === 'SUITE' && c.subs.length > 0) {\n             const bathW = rowRect.w * 0.35; \n             const bedW = rowRect.w - bathW;\n             \n             if (side === 'LEFT') {\n                regions.push({ x: rowRect.x, y: currentY, w: bathW, h: rowH, type: c.subs[0] });\n                regions.push({ x: rowRect.x + bathW, y: currentY, w: bedW, h: rowH, type: c.main });\n             } else {\n                regions.push({ x: rowRect.x, y: currentY, w: bedW, h: rowH, type: c.main });\n                regions.push({ x: rowRect.x + bedW, y: currentY, w: bathW, h: rowH, type: c.subs[0] });\n             }\n          } else {\n             regions.push({ ...rowRect, type: c.main });\n          }\n          currentY += rowH;\n       });\n    };\n\n    stackWing(leftWing, leftClusters, 'LEFT');\n    stackWing(rightWing, rightClusters, 'RIGHT');\n    \n    allFloorsRegions.push(regions);\n  });\n\n  blackboard.write('floorRegions', allFloorsRegions);\n  return true;\n};\n\n// --- AGENT 3: STRUCTURAL ---\nconst StructuralAgent = async () => {\n  LOG('Building Walls...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allWalls = [];\n\n  floorRegions.forEach((rooms) => {\n    const walls = [];\n    rooms.forEach(r => {\n      walls.push({ x1: r.x, y1: r.y, x2: r.x+r.w, y2: r.y, type: 'inner' });\n      walls.push({ x1: r.x, y1: r.y+r.h, x2: r.x+r.w, y2: r.y+r.h, type: 'inner' });\n      walls.push({ x1: r.x, y1: r.y, x2: r.x, y2: r.y+r.h, type: 'inner' });\n      walls.push({ x1: r.x+r.w, y1: r.y, x2: r.x+r.w, y2: r.y+r.h, type: 'inner' });\n    });\n    \n    const b = blackboard.read('siteBoundary');\n    const outer = [\n      { x1: b.x, y1: b.y, x2: b.x+b.w, y2: b.y },\n      { x1: b.x, y1: b.y+b.h, x2: b.x+b.w, y2: b.y+b.h },\n      { x1: b.x, y1: b.y, x2: b.x, y2: b.y+b.h },\n      { x1: b.x+b.w, y1: b.y, x2: b.x+b.w, y2: b.y+b.h },\n    ];\n    allWalls.push({ inner: walls, outer: outer });\n  });\n  blackboard.write('floorWalls', allWalls);\n  return true;\n};\n\n// --- AGENT 4: DOORS ---\nconst ConnectivityAgent = async () => {\n  LOG('Placing Doors...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allDoors = [];\n\n  floorRegions.forEach((rooms, floorIndex) => {\n    const doors = [];\n    const addDoor = (d) => { if(!doors.some(x=>Math.abs(x.x-d.x)<1 && Math.abs(x.y-d.y)<1)) doors.push(d); };\n\n    rooms.forEach((r1, i) => {\n      rooms.forEach((r2, j) => {\n        if(i <= j) return;\n        \n        const overlapX = (Math.min(r1.x+r1.w, r2.x+r2.w) - Math.max(r1.x, r2.x));\n        const overlapY = (Math.min(r1.y+r1.h, r2.y+r2.h) - Math.max(r1.y, r2.y));\n        const touchX = Math.abs(r1.x+r1.w - r2.x) < 0.1 || Math.abs(r2.x+r2.w - r1.x) < 0.1;\n        const touchY = Math.abs(r1.y+r1.h - r2.y) < 0.1 || Math.abs(r2.y+r2.h - r1.y) < 0.1;\n\n        const r1Hall = r1.type === 'hallway';\n        const r2Hall = r2.type === 'hallway';\n        \n        if (r1Hall || r2Hall) {\n           if (touchX && overlapY > 3) addDoor({x: (r1.x<r2.x?r2.x:r1.x), y: Math.max(r1.y,r2.y)+overlapY/2-1.5, w:3, vertical:true});\n           else if (touchY && overlapX > 3) addDoor({x: Math.max(r1.x,r2.x)+overlapX/2-1.5, y: (r1.y<r2.y?r2.y:r1.y), w:3, vertical:false});\n        }\n        \n        const r1Bath = r1.type === 'bathroom';\n        const r2Bath = r2.type === 'bathroom';\n        const r1Bed = r1.type.includes('bed');\n        const r2Bed = r2.type.includes('bed');\n        \n        if ((r1Bath && r2Bed) || (r2Bath && r1Bed)) {\n           if (touchX && overlapY > 3) addDoor({x: (r1.x<r2.x?r2.x:r1.x), y: Math.max(r1.y,r2.y)+overlapY/2-1.5, w:3, vertical:true});\n        }\n      });\n    });\n    \n    if(floorIndex === 0) {\n       const hall = rooms.find(r=>r.type === 'hallway');\n       if(hall) addDoor({x: hall.x+hall.w/2-2, y: hall.y+hall.h, w:4, vertical:false});\n    }\n\n    allDoors.push(doors);\n  });\n  blackboard.write('floorDoors', allDoors);\n  return true;\n};\n\n// ... existing agents ...\n\n// --- AGENT 5: INTERIOR DESIGNER ---\nconst InteriorAgent = async () => {\n  LOG('Arranging Interior Furniture...');\n  const floorRegions = blackboard.read('floorRegions');\n  const allFurniture = [];\n\n  floorRegions.forEach(rooms => {\n    const floorItems = [];\n    \n    rooms.forEach(r => {\n      const cx = r.x + r.w / 2;\n      const cy = r.y + r.h / 2;\n\n      // Helper to ensure furniture stays inside bounds\n      const safeW = (val) => Math.min(val, r.w - 2);\n      const safeH = (val) => Math.min(val, r.h - 2);\n\n      switch (true) {\n        case r.type.includes('bed'):\n          const isMaster = r.type === 'master-bed';\n          const bedW = isMaster ? 6 : 4;\n          const bedH = 6;\n          // Place bed against the \"top\" wall of the room\n          floorItems.push({ \n             type: 'bed', x: cx - bedW/2, y: r.y + 1.5, w: bedW, h: bedH \n          });\n          // Pillows\n          floorItems.push({ type: 'pillow', x: cx - bedW/2 + 0.5, y: r.y + 2, w: 1.5, h: 1 });\n          if(isMaster) floorItems.push({ type: 'pillow', x: cx + bedW/2 - 2, y: r.y + 2, w: 1.5, h: 1 });\n          \n          // Wardrobe (side wall)\n          floorItems.push({ type: 'storage', x: r.x + 0.5, y: r.y + 1, w: 2, h: r.h/2 });\n          break;\n\n        case r.type === 'living':\n          // L-Shaped Sofa approximation (Main piece + side piece)\n          floorItems.push({ type: 'sofa', x: r.x + 2, y: r.y + 2, w: 2.5, h: 8 }); // Vertical back\n          floorItems.push({ type: 'sofa', x: r.x + 2, y: r.y + 2, w: 8, h: 2.5 }); // Horizontal back\n          // Coffee Table\n          floorItems.push({ type: 'table', x: r.x + 5.5, y: r.y + 5.5, w: 4, h: 3 });\n          // TV Stand (Opposite wall)\n          floorItems.push({ type: 'storage', x: r.x + r.w - 2, y: cy - 4, w: 1.5, h: 8 });\n          break;\n\n        case r.type === 'dining':\n          // Large Table\n          floorItems.push({ type: 'table', x: cx - 3, y: cy - 4, w: 6, h: 8 });\n          // Chairs (visual dots)\n          floorItems.push({ type: 'chair', x: cx - 4, y: cy - 2, w: 1, h: 1 });\n          floorItems.push({ type: 'chair', x: cx + 3, y: cy - 2, w: 1, h: 1 });\n          floorItems.push({ type: 'chair', x: cx - 4, y: cy + 1, w: 1, h: 1 });\n          floorItems.push({ type: 'chair', x: cx + 3, y: cy + 1, w: 1, h: 1 });\n          break;\n\n        case r.type === 'kitchen':\n          // Countertops along the edges\n          floorItems.push({ type: 'counter', x: r.x, y: r.y, w: r.w, h: 2 }); // Top\n          floorItems.push({ type: 'counter', x: r.x, y: r.y, w: 2, h: r.h }); // Left\n          // Island\n          if(r.w > 10 && r.h > 10) {\n             floorItems.push({ type: 'counter', x: cx - 2, y: cy - 2, w: 4, h: 4 });\n          }\n          break;\n\n        case r.type === 'bathroom':\n          // Corner Shower\n          floorItems.push({ type: 'counter', x: r.x, y: r.y, w: 3, h: 3 });\n          // Sink\n          floorItems.push({ type: 'fixture', x: r.x, y: r.y + 4, w: 2, h: 2 });\n          break;\n          \n        case r.type === 'study' || r.type === 'library':\n          // Desk\n          floorItems.push({ type: 'table', x: r.x + 1, y: r.y + 1, w: 2.5, h: 6 });\n          break;\n      }\n    });\n    allFurniture.push(floorItems);\n  });\n\n  blackboard.write('floorFurniture', allFurniture);\n  return true;\n};\n\nexport const agents = [\n  { name: 'Zoning & Logic', fn: ZoningAgent },\n  { name: 'Spine-Stacker Layout', fn: LayoutAgent },\n  { name: 'Structural Skeleton', fn: StructuralAgent },\n  { name: 'Interior Designer', fn: InteriorAgent }, // <--- Added here\n  { name: 'Access Grapher', fn: ConnectivityAgent },\n];\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}